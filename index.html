<!DOCTYPE html>
<html>
<head>
  <meta charset='utf-8'>

  <title>psy1337/JSON-Grep @ GitHub</title>

  <style type="text/css">
    body {
      margin-top: 1.0em;
      font-family: Helvetica, Arial, FreeSans, san-serif;
      color: #000000;
    }
    #container {
      margin: 0 auto;
      width: 700px;
    }
    h1 { font-size: 3.8em; margin-bottom: 3px; }
    h1 .small { font-size: 0.3em; }
    h1 a { text-decoration: none }
    h2 { font-size: 1.5em;}
    h3 { text-align: center; }
    .description { font-size: 1.2em; margin-bottom: 30px; margin-top: 30px; font-style: italic;}
    .download { float: right; }
    pre { background: #000; color: #fff; padding: 15px;}
    hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
    .footer { text-align:center; padding-top:30px; font-style: italic; }
  </style>
</head>

<body>
  <a href="http://github.com/psy1337/JSON-Grep"><img style="position: absolute; top: 0; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub" /></a>

  <div id="container">

    <div class="download">
      <a href="http://github.com/psy1337/JSON-Grep/zipball/master">
        <img border="0" width="90" src="http://github.com/images/modules/download/zip.png"></a>
      <a href="http://github.com/psy1337/JSON-Grep/tarball/master">
        <img border="0" width="90" src="http://github.com/images/modules/download/tar.png"></a>
    </div>

    <h1><a href="http://github.com/psy1337/JSON-Grep">JSON-Grep</a>
      <span class="small">by <a href="http://github.com/psy1337">Pieter Loubser</a></span></h1>

    <div class="description">
      JGrep is a command line tool and API for parsing JSON documents based on logical expressions.

    </div>

    <h2>Install</h2>
        <p><pre><code>$ gem install jgrep</code></pre></p>

    <h2>JGrep on the CLI</h2>
    <p> JGrep can be invoked by either piping data to it
    <pre><code>$ cat foo.json | jgrep [expression]</code></pre>
    or by using the i flag to specify an input file.
    <pre><code>$ jgrep [expression] -i foo.json</code></pre>
    </p>

    <p> <b>Flags</b>

        <pre><code>
-s "[Document fields]"  : Greps the JSON and only returns the value of field(s)
                          specified
-c                      : Returns the JSON in its non-pretty flat form
-f                      : Flatten the results as much as possible
-v                      : Verbose output that will list a document if it fails to
                          parse
-i [FILENAME]           : Target JSON file to use as input
--start FIELD           : Starts the grep at a specific key in the document
        </code></pre>
    </p>

    <p>
    <b>Expressions</b><br><br>

    JGrep uses the following logic symbols to define expressions:

    <pre><code>
    'and' :
         - [statement] and [statement]

        Evaluates to true if both statements are true

    'or' :
        - [statement] and [statement]

         Evaluates true if either statement is true

    'not' :
        - ! [statement]
        - not [statement]

        Inverts the value of statement

    '+' :
        - +[value]

        Returns true if value is present in the json document

    '-' :
        - -[value]

        Returns true if value is not present in the json doument

    '(' and ')' :
        - (expression1) and expression2

        Performs the operations inside the perentheses first.

    </code></pre>
    </p>

    <p>
    <b>Statements</b><br><br>
    A statement is defined as some value in a json document compared to another value. Available comparison operators are '=', '<', '>', '<=', '>=', '!='.

    Example :

    <pre><code>
    foo.bar=1
    foo.bar&lt;0
    foo.bar&lt;=1.3
    </code></pre>

    </p>

    <p>
    <b>Complex expressions</b><br><br>

    Given a json document, {"foo":1, "bar":null}, the following are valid expressions:

    <pre><code>+foo</code></pre>
    ... returns true
    <pre><code>-foo</code></pre>
    ... returns false
    <pre><code>+foo and !(foo=2)</code></pre>
    ... returns true
    <pre><code>!(foo&gt;=2 and bar=null) or !(bar=null)</code></pre>
    ... returns true
    </p>


    <p>
    <b>JGrep without expressions</b><br><br>
    If JGrep is executed without a set expression, it will return an unmodified JSON document. The -s flag can still be applied to the result.
    </p>

    <p>
    <b>In-document comparison</b><br><br>
    If a document contains an array, the '[' and ']' symbols can be used to define a comparison where statements are checked for truth on a per element basis which will then be combined.

    Consider:

    <pre><code>[foo.bar1=1 and foo.bar2=2]</code></pre>

    on:

    <pre><code>
[
  {
    "foo":  [
      {
        "bar1":1
      },
      {
        "bar2":2
      }
    ],
  },
  {
    "foo":  [
      {
        "bar1":0
      },
      {
        "bar2":0
      }
    ]
  }
]
    </code></pre>

    will return:

    <pre><code>
[
  {
    "foo": [
      {
        "bar1": 1
      },
      {
        "bar2": 2
      }
    ]
  }
]
    </code></pre>

    <b>Note:</b> In-document comparison cannot be nested.
    </p>

    <p>
    <b>The -s flag</b><br><br>

    The -s flag simplifies the output returned by JGrep. Given a JSON document:

<pre><code>[{"a":1, "b":2, "c":3}, {"a":3, "b":2, "c":1}]</code></pre>

    the JGrep invocation:
<pre><code>$ cat my.json | jgrep "a=1" -s b</code></pre>
    will ouput:
<pre><code>1</code></pre>

The -s flag can also be used with multiple fields, which will return JSON as output that only contain the specified fields.

Given:

<pre><code>[{"a":1, "b":2, "c":3}, {"a":3, "b":2, "c":1}]</code></pre>

the JGrep invocation:

<pre><code>$ cat my.json | jgrep "a&gt;0" -s "a c"</code></pre>
will output:
<pre><code>
[
  {
    "a" : 1,
    "c" : 3
  },
  {
    "a" : 3,
    "c" : 1
  }
]
</code></pre>
    </p>

<p>
<b>The -start flag</b><br><br>
Some documents do not comply with our expected format, they might have an array embedded deep in a field. The --start flag lets you pick a starting point for the grep.

An example document can be seen here:

<pre><code>
{"results": [
              {"name":"Jack", "surname":"Smith"},
              {"name":"Jill", "surname":"Jones"}
            ]
}
</code></pre>

This document does not comply with our standard, but does contain data that can be searched - the results field. We can use the --start flag to tell jgrep to start looking for data in that field:

<pre><code>
$ cat my.json | jgrep --start results name=Jack -s surname
Smith
</code></pre>
</p>

    <h2>JGrep Gem usage:</h2>
    <p><pre><code>
require 'jgrep'

json = File.read("yourfile.json")
expression = "foo=1 or bar=1"

JGrep::jgrep(json, expression)

sflags = "foo"

JGrep::jgrep(json, expression, sflags)
    </code></pre></p>

    <h2>Documentation</h2>
    <p> API documentation can be found <a href=http://rubydoc.info/gems/jgrep/1.2.1/frames>here</a>.

    <h2>Issues</h2>
    <p> Feel free to report any and all bugs, issues and feature requests <a href=https://github.com/psy1337/JSON-Grep/issues>here</a>.

    <h2>Author</h2>
        <p>Pieter Loubser (ploubser@gmail.com)</p>

    <h2>Contributors</h2>
    <p> R.I.Pienaar (rip@devco.net) <br/>Ken Barber (ken@bob.sh) </p>

    <h2>Contact</h2>
        <p>Pieter Loubser (ploubser@gmail.com)<br/>      </p>


    <h2>Download</h2>
    <p>
      You can download this project in either
      <a href="http://github.com/psy1337/JSON-Grep/zipball/master">zip</a> or
      <a href="http://github.com/psy1337/JSON-Grep/tarball/master">tar</a> formats.
    </p>
    <p>You can also clone the project with <a href="http://git-scm.com">Git</a>
      by running:
      <pre>$ git clone git://github.com/psy1337/JSON-Grep</pre>
    </p>

  </div>


</body>
</html>
